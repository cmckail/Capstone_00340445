{"version":3,"sources":["common/history.js","common/TokenCheck.js","App.js","index.js"],"names":["history","createBrowserHistory","parseJwt","token","JSON","parse","atob","split","e","isValidUser","user","localStorage","getItem","accessToken","exp","Date","now","Home","lazy","Login","Register","Profile","Marketplace","ProductPage","Success","UserAppointments","MerchantAppointments","NavLinkStyled","styled","Link","App","useState","currentUser","setCurrentUser","useEffect","listen","console","log","logOut","useCallback","removeItem","push","fallback","Container","style","width","padding","Box","sx","flexGrow","AppBar","position","Toolbar","Typography","component","size","edge","to","color","mr","textDecoration","username","Button","onClick","exact","path","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.e9cc616f.chunk.js","sourcesContent":["import { createBrowserHistory } from \"history\";\n\nexport const history = createBrowserHistory();\n","import React from \"react\";\nimport { Redirect } from \"react-router\";\nimport { history } from './history';\n\nexport const parseJwt = (token) => {\n  try {\n    return JSON.parse(atob(token.split(\".\")[1]));\n  } catch (e) {\n    return null;\n  }\n};\n\nexport const isValidUser = () => {\n  const user = JSON.parse(localStorage.getItem(\"user\"));\n  if (user) {\n    const decodedToken = parseJwt(user.accessToken);\n\n    if (decodedToken.exp * 1000 > Date.now()) {\n      return true\n    }\n  }\n  return false\n}\n","import React, { useState, useEffect, useCallback, lazy, Suspense } from \"react\";\nimport { Router, Switch, Route, Link } from \"react-router-dom\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { Container, Box, Button, Typography, AppBar, Toolbar, styled } from \"@mui/material\";\nimport { history } from \"./common/history\";\nimport { parseJwt } from \"./common/TokenCheck\";\nconst Home = lazy(() => import(\"./components/Home\"));\nconst Login = lazy(() => import(\"./components/Login\"));\nconst Register = lazy(() => import(\"./components/Register\"));\nconst Profile = lazy(() => import(\"./components/Profile\"));\nconst Marketplace = lazy(() => import(\"./components/Marketplace\"));\nconst ProductPage = lazy(() => import(\"./components/ProductPage\"));\nconst Success = lazy(() => import(\"./components/Success\"));\nconst UserAppointments = lazy(() => import(\"./components/UserAppointments\"));\nconst MerchantAppointments = lazy(() => import(\"./components/MerchantAppointments\"));\n\n\nconst NavLinkStyled = styled(Link)`\n  color:'red';\n  &:hover: {\n    color: blue;\n  }\n`;\n\nconst App = () => {\n\n  // var currentUser = JSON.parse(localStorage.getItem(\"user\"));\n  const [currentUser, setCurrentUser] = useState({})\n\n  //Every render check if user is valid, else kick to out of app\n  useEffect(() => {\n    history.listen(() => {\n      const user = JSON.parse(localStorage.getItem(\"user\"));\n      setCurrentUser(user);\n      console.log('user', user);\n      if (user) {\n        const decodedJwt = parseJwt(user.accessToken);\n\n        if (decodedJwt.exp * 1000 < Date.now()) {\n          logOut();\n        }\n      }\n    });\n  });\n\n  useEffect(() => {\n    // for some reason logout gets caught here but not login\n    setCurrentUser(JSON.parse(localStorage.getItem(\"user\")));\n  }, [history])\n\n  const logOut = useCallback(() => {\n    localStorage.removeItem(\"user\");\n    history.push('/login');\n    setCurrentUser(null)\n  }, []);\n\n  return (\n    <Suspense fallback={<Container><h1>...loading</h1> </Container>}>\n      <Router history={history}>\n        <Container style={{ width: \"100%\", padding: '0' }}>\n          <Box sx={{ flexGrow: 1 }}>\n            <AppBar position=\"static\">\n              <Toolbar>\n                <Typography\n                  component={NavLinkStyled}\n                  size=\"large\"\n                  edge=\"start\"\n                  to={\"/\"}\n                  color=\"white\"\n                  sx={{ mr: 2 }}\n                >\n                </Typography>\n                <Typography component={NavLinkStyled} to={\"/\"} color=\"white\" sx={{ flexGrow: 1, textDecoration: 'none' }}>\n                  Tadoo\n                </Typography>\n                {currentUser ? (\n                  <>\n                    <Typography component={NavLinkStyled} to={`/profile/${currentUser.username}`} color=\"white\" sx={{ flexGrow: 1, textDecoration: 'none' }}>\n                      {currentUser.username}\n                    </Typography>\n                    <Typography component={NavLinkStyled} to={`/market`} color=\"white\" sx={{ flexGrow: 1, textDecoration: 'none' }}>\n                      Marketplace\n                    </Typography>\n                    <Typography component={NavLinkStyled} to={`/myAppointments`} color=\"white\" sx={{ flexGrow: 1, textDecoration: 'none' }}>\n                      Appointment\n                    </Typography>\n                    <Button\n                      onClick={logOut}\n                      style={{\n                        color: 'white'\n                      }}\n                    >\n                      Logout\n                    </Button>\n                  </>\n                ) :\n                  (\n                    <>\n                      <Typography component={NavLinkStyled} to={`/register`} color=\"white\" sx={{ flexGrow: 1, textDecoration: 'none' }}>\n                        Register\n                      </Typography>\n                      <Typography component={NavLinkStyled} to={`/login`} color=\"white\" sx={{ flexGrow: 1, textDecoration: 'none' }}>\n                        Login\n                      </Typography>\n                    </>\n                  )}\n              </Toolbar>\n            </AppBar>\n          </Box>\n          <div>\n            <Switch>\n              <Route exact path={[\"/\", \"/home\"]} component={Home} />\n              <Route exact path=\"/login\" component={Login} />\n              <Route exact path=\"/register\" component={Register} />\n              <Route exact path=\"/profile/:username\" component={Profile} />\n              <Route path=\"/market\" exact component={Marketplace} />\n              <Route path=\"/market/:id\" component={ProductPage} />\n              <Route path=\"/myAppointments\" component={UserAppointments} />\n              <Route path=\"/merchantAppointments\" component={MerchantAppointments} />\n              <Route path=\"/success\" component={Success} />\n            </Switch>\n          </div>\n        </Container>\n      </Router>\n    </Suspense >\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <App />,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}